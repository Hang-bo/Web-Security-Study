# 正则表达式Regular expression

正则表达式可以从一个基础字符串中根据一定的匹配模式替换文本中的字符串、验证表单、提取字符串等等。

## 1.基本匹配

"the" => The fat cat sat on **the** mat.



## 2.元字符

元字符不代表他们本身的字面意思，他们都有特殊的含义。

一些元字符写在方括号中的时候有一些特殊的意思。

| 元字符 | 描述                                                         |
| ------ | ------------------------------------------------------------ |
| .      | 句号匹配任意单个字符除了换行符。                             |
| [ ]    | 字符种类。匹配方括号内的任意字符。                           |
| [^ ]   | 否定的字符种类。匹配除了方括号里的任意字符                   |
| *      | 匹配>=0个重复的在*号之前的字符。                             |
| +      | 匹配>=1个重复的+号前的字符。                                 |
| ?      | 标记?之前的字符为可选.                                       |
| {n,m}  | 匹配num个大括号之前的字符或字符集 (n <= num <= m).           |
| (xyz)  | 字符集，匹配与 xyz 完全相等的字符串.                         |
| \|     | 或运算符，匹配符号前或后的字符.                              |
| \      | 转义字符,用于匹配一些保留的字符 `[ ] ( ) { } . * + ? ^ $ \ |` |
| ^      | 从开始行开始匹配.                                            |
| $      | 从末端开始匹配.                                              |

### 点运算符 .

.匹配任意单个字符，但不匹配换行符。

相当于可以代替一个字符

### 字符集

字符集也叫做字符类。 方括号用来指定一个字符集。

在方括号中使用连字符来**指定字符集的范围**

"[ Tt ] he" => **The** car parked in **the** garage.

#### 否定字符集

^用在一个方括号的开头的时候，它表示这个字符集是否定的

"[ ^ c     ] ar" => The car **par**ked in the **gar**age.

### 重复次数

跟着元字符 +，* ， ? 的，用来指定匹配子模式的次数。

#### * 号

*号匹配 在 *之前的字符出现大于等于0次

0次：可以不用出现

.*任意字符出现>=0次

```php
"[a-z]*" => The car parked in the garage #21.//匹配小写字母开头的字符串
```

#### + 号

+号匹配+号之前的字符出现 >=1 次

1次：至少出现一次

.+任意字符出现>=1次

#### ? 号

##### 可选匹配

表达式 [T]?he 匹配字符串 he 和 The

##### 慵懒匹配

c.+?t——只匹配较少字符的字符串

The fat **cat** sat on the mat.

### {} 号

限定一个或一组字符可以重复出现的次数。

`[0-9]{2,3}` 匹配最少 2 位最多 3 位 0~9 的数字。

`[0-9]{2,}` 匹配至少两位 0~9 的数字。

`[0-9]{3}` 匹配3位数字

### `(...)` 特征标群

`(...)` 中包含的内容将会被看成一个整体

- （ab)*匹配连续出现 0 或更多个ab

- 在 `{}` 前加上特征标群 `(...)` 则表示整个标群内的字符重复 N 次。

- 或：

  "(c|g|p)ar" => The **car** is **par**ked in the **gar**age.

### | 或运算符

- "(T|t)he|car" => **The car** is parked in **the** garage

### 转码特殊字符

反斜线 `\` 在表达式中用于转码紧跟其后的字符。

用于指定 `{ } [ ] / \ + * . $ ^ | ?` 这些特殊字符

- 选择性匹配：

  "(f|c|m)at\.?" => The **fat cat** sat on the **mat**.

### 锚点

匹配指定开头或结尾的字符串就要使用到锚点。`^` 指定开头，`$` 指定结尾。

#### ^ 号

`^` 用来检查匹配的字符串是否在所匹配字符串的开头。

- "^(T|t)he" => **The** car is parked in the garage.

#### $ 号

`$` 号用来匹配字符是否是最后一个。

- "(at\.)$" => The fat cat. sat. on the m**at.**



## 3.简写字符集

| 简写 | 描述                                               |
| ---- | -------------------------------------------------- |
| .    | 除换行符外的所有字符                               |
| \w   | 匹配所有字母数字，等同于 `[a-zA-Z0-9_]`            |
| \W   | 匹配所有非字母数字，即符号，等同于： `[^\w]`       |
| \d   | 匹配数字： `[0-9]`                                 |
| \D   | 匹配非数字： `[^\d]`                               |
| \s   | 匹配所有空格字符，等同于： `[\t\n\f\r\p{Z}]`       |
| \S   | 匹配所有非空格字符： `[^\s]`                       |
| \f   | 匹配一个换页符                                     |
| \n   | 匹配一个换行符                                     |
| \r   | 匹配一个回车符                                     |
| \t   | 匹配一个制表符                                     |
| \v   | 匹配一个垂直制表符                                 |
| \p   | 匹配 CR/LF（等同于 `\r\n`），用来匹配 DOS 行终止符 |



## 4.零宽度断言

先行断言（匹配前面找后面符合的）和后发断言（匹配后面找前面符合的）（合称 lookaround）都属于**非捕获组**（用于匹配模式，但不包括在匹配列表中）

| 符号 | 描述            |
| ---- | --------------- |
| ?=   | 正先行断言-存在 |
| ?!   | 负先行断言-排除 |
| ?<=  | 正后发断言-存在 |
| ?<!  | 负后发断言-排除 |

### ?=... 正先行断言

表示第一部分表达式**之后**必须跟着 `?=...`定义的表达式，返回结果只包含满足匹配条件的**第一部分表达式。**

- 定义一个正先行断言要使用 `()`。在括号内部使用一个问号和等号： `(?=...)`。
- "(T|t)he(?=**\s**fat)" => **The** fat cat sat on the mat.

### ?!... 负先行断言

用于筛选所有匹配结果，筛选条件为 **其后**不跟随着断言中定义的格式。

- "(T|t)he(?!\sfat)" => The fat cat sat on **the** mat.

### ?<= ... 正后发断言

用于筛选所有匹配结果，筛选条件为 **其前**跟随着断言中定义的格式。

- "(?<=(T|t)he\s)(fat|mat)" => The **fat** cat sat on the **mat**.

### ?<!... 负后发断言

用于筛选所有匹配结果，筛选条件为 **其前**不跟随着断言中定义的格式。

- "(?<!(T|t)he\s)(cat)" => The cat sat on **cat**.



## 5.标志

也叫模式修正符，因为它可以用来修改表达式的搜索结果。

| 标志 | 描述                                                  |
| ---- | ----------------------------------------------------- |
| i    | 忽略大小写。                                          |
| g    | 全局搜索。                                            |
| m    | 多行修饰符：锚点元字符 `^` `$` 工作范围在每行的起始。 |

两个/......./之间的字符串表示一个正则表达式

### 忽略大小写(Case Insensitive)

修饰语 `i` 用于忽略大小写。

- "/The/gi" => **The** fat cat sat on **the** mat.

### 全局搜索 (Global search)

修饰符 `g` 常用于执行一个全局搜索匹配，即（不仅仅返回第一个匹配的，而是**返回全部结果**）。

- "/.(at)/" => The **fat** cat sat on the mat.
- "/.(at)/g" => The **fat cat sat** on the **mat**.

### 多行修饰符 (Multiline)

常用于执行一个多行匹配。

根据 `m` 修饰符，现在表达式匹配每行的结尾。

否则只按单行检测结尾

"/.at(.)?$/gm" => The **fat**
                			  cat **sat**
                  			on the **mat.**



## 6.贪婪匹配与惰性匹配 (Greedy vs lazy matching)

- 默认采用贪婪匹配模式，在该模式下意味着会匹配尽可能长的子串。
- 使用 `?` 将贪婪匹配模式转化为**惰性**匹配模式，尽可能短。

- "/(.*at)/" => **The fat cat sat on the mat**. 
- "/(.*?at)/" => **The fat** cat sat on the mat. 

